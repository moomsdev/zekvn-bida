(()=>{"use strict";var e;e=jQuery,window.PUM_Admin=window.PUM_Admin||{},window.pum_theme_settings_editor=window.pum_theme_settings_editor||{form_args:{},current_values:{}},PUM_Admin.themeEditor={preview_fixed_scroll:function(){var t=e("#pum_theme_preview"),o=t.parent(),i=t.offset().top-50;e(window).on("scroll",function(){e("> .postbox:visible",o).index(t)===e("> .postbox:visible",o).length-1&&e(window).scrollTop()>=i?t.css({left:t.offset().left,width:t.width(),height:t.height(),position:"fixed",top:50}):t.removeAttr("style")})},update_font_options:function(t){var o,i,n=e('select[id="'+t+'_font_family"]'),r=e('select[id="'+t+'_font_weight"]'),s=e('select[id="'+t+'_font_style"]'),l=r.find("option"),a=s.find("option"),_=[400,300,700,100,200,500,600,800,900],p=["","italic"],c=n.val(),d=r.val(),h=s.val();if(void 0!==pum_google_fonts[c]){if(o=pum_google_fonts[c],l.prop("disabled",!0),a.prop("disabled",!0),o.variants.length)for(i=0;o.variants.length>i;i+=1)"regular"===o.variants[i]?(e('option[value="400"]',r).prop("disabled",!1),e('option[value=""]',s).prop("disabled",!1)):(o.variants[i].indexOf("italic")>=0&&e('option[value="italic"]',s).prop("disabled",!1),e('option[value="'+parseInt(o.variants[i],10)+'"]',r).prop("disabled",!1))}else l.prop("disabled",!1),a.prop("disabled",!1);if(""===d||l.filter('[value="'+d+'"]').is(":disabled"))for(i=0;_.length>i;i+=1)if(!l.filter('[value="'+_[i]+'"]').is(":disabled")){r.val(_[i]);break}if(a.filter('[value="'+h+'"]').is(":disabled"))for(i=0;p.length>i;i+=1)if(!a.filter('[value="'+p[i]+'"]').is(":disabled")){s.val(p[i]);break}n.trigger("change.select2"),r.trigger("change.select2"),n.trigger("change.select2"),r=r.parents(".pum-field"),l.filter(":not(:disabled)").length>1?r.show():r.hide(),n=s.parents(".pum-field"),a.filter(":not(:disabled)").length>1?n.show():n.hide()},update_font_selectboxes:function(){return e('select[id$="_font_family"]').each(function(){PUM_Admin.themeEditor.update_font_options(e(this).attr("id").replace("_font_family",""))})},update_loaded_font:function(t){var o,i=e('select[id="'+t+'_font_family"]'),n=e('select[id="'+t+'_font_weight"]'),r=e('select[id="'+t+'_font_style"]'),s=i.val(),l=n.val(),a=r.val(),_=e("link#pum-"+t+"google-font"),p=e('<link id="pum-'+t+'google-font" rel="stylesheet" type="text/css">');void 0!==pum_google_fonts[s]?(o="//fonts.googleapis.com/css?family="+s,"normal"!==l&&(o+=":"+l),"italic"===a&&(-1===o.indexOf(":")&&(o+=":"),o+="italic"),p.attr("href",o),_.length?_.attr("href")!==o&&_.replaceWith(p):e("body").append(p)):_.remove()},update_loaded_fonts:function(){return e('select[id$="_font_family"]').each(function(){PUM_Admin.themeEditor.update_loaded_font(e(this).attr("id").replace("_font_family",""))})},refresh_preview:function(){var t=e("#pum-theme-settings-container").pumSerializeObject(),o=t.theme_settings;if(void 0!==window.PUM_ATB)for(var i in delete t.theme_settings,t)t.hasOwnProperty(i)&&(o[i.replace("popup_theme_","")]=t[i]);PUM_Admin.themeEditor.restyle_preview(o)},restyle_preview:function(t){var o,i,n,r,s=e(".pum-popup-overlay"),l=e(".pum-popup-container"),a=e(".pum-popup-title",l),_=e(".pum-popup-content",l),p=e(".pum-popup-close",l),c="yes"===t.container_boxshadow_inset?"inset ":"",d="yes"===t.close_boxshadow_inset?"inset ":"";switch(PUM_Admin.themeEditor.update_loaded_fonts(),s.removeAttr("style").css({backgroundColor:window.PUM_Admin.utils.convert_hex(t.overlay_background_color,t.overlay_background_opacity)}),l.removeAttr("style").css({padding:t.container_padding+"px",backgroundColor:window.PUM_Admin.utils.convert_hex(t.container_background_color,t.container_background_opacity),borderStyle:t.container_border_style,borderColor:t.container_border_color,borderWidth:t.container_border_width+"px",borderRadius:t.container_border_radius+"px",boxShadow:c+t.container_boxshadow_horizontal+"px "+t.container_boxshadow_vertical+"px "+t.container_boxshadow_blur+"px "+t.container_boxshadow_spread+"px "+window.PUM_Admin.utils.convert_hex(t.container_boxshadow_color,t.container_boxshadow_opacity)}),a.removeAttr("style").css({color:t.title_font_color,lineHeight:t.title_line_height+"px",fontSize:t.title_font_size+"px",fontFamily:t.title_font_family,fontStyle:t.title_font_style,fontWeight:t.title_font_weight,textAlign:t.title_text_align,textShadow:t.title_textshadow_horizontal+"px "+t.title_textshadow_vertical+"px "+t.title_textshadow_blur+"px "+window.PUM_Admin.utils.convert_hex(t.title_textshadow_color,t.title_textshadow_opacity)}),_.removeAttr("style").css({color:t.content_font_color,fontFamily:t.content_font_family,fontStyle:t.content_font_style,fontWeight:t.content_font_weight}),p.removeAttr("style").css({position:t.close_position_outside?"fixed":"absolute",padding:t.close_padding+"px",height:t.close_height>0?t.close_height+"px":"auto",width:t.close_width>0?t.close_width+"px":"auto",backgroundColor:window.PUM_Admin.utils.convert_hex(t.close_background_color,t.close_background_opacity),color:t.close_font_color,lineHeight:t.close_line_height+"px",fontSize:t.close_font_size+"px",fontFamily:t.close_font_family,fontWeight:t.close_font_weight,fontStyle:t.close_font_style,borderStyle:t.close_border_style,borderColor:t.close_border_color,borderWidth:t.close_border_width+"px",borderRadius:t.close_border_radius+"px",boxShadow:d+t.close_boxshadow_horizontal+"px "+t.close_boxshadow_vertical+"px "+t.close_boxshadow_blur+"px "+t.close_boxshadow_spread+"px "+window.PUM_Admin.utils.convert_hex(t.close_boxshadow_color,t.close_boxshadow_opacity),textShadow:t.close_textshadow_horizontal+"px "+t.close_textshadow_vertical+"px "+t.close_textshadow_blur+"px "+window.PUM_Admin.utils.convert_hex(t.close_textshadow_color,t.close_textshadow_opacity)}),t.close_text=t.close_text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),p.html(t.close_text),o=t.close_position_top+(t.close_position_outside?e("#wpadminbar").outerHeight():0),i=t.close_position_left+(t.close_position_outside?e("#adminmenuwrap").outerWidth():0),n=t.close_position_right,r=t.close_position_bottom,t.close_location){case"topleft":p.css({top:o+"px",left:i+"px"});break;case"topcenter":p.css({top:o+"px",left:"50%",transform:"translateX(-50%)"});break;case"topright":p.css({top:o+"px",right:n+"px"});break;case"middleleft":p.css({top:"50%",left:i+"px",transform:"translateY(-50%)"});break;case"middleright":p.css({top:"50%",right:n+"px",transform:"translateY(-50%)"});break;case"bottomleft":p.css({bottom:r+"px",left:i+"px"});break;case"bottomcenter":p.css({bottom:r+"px",left:"50%",transform:"translateX(-50%)"});break;case"bottomright":p.css({bottom:r+"px",right:n+"px"})}e(document).trigger("popmake-admin-retheme",[t]),e(document).trigger("pumRestylePreview",[t])}},e(document).on("change",'select[id$="_font_family"]',function(){var t=e(this).attr("id").replace("_font_family","");PUM_Admin.themeEditor.update_font_options(t)}).on("click",".pum-popup-overlay, .pum-popup-container, .pum-popup-title, .pum-popup-content, .pum-popup-close",function(t){var o=e(this).attr("class");switch(t.preventDefault(),t.stopPropagation(),o){case"pum-popup-overlay":e('a[href="#pum-theme-settings_overlay"]')[0].click();break;case"pum-popup-container":e('a[href="#pum-theme-settings_container"]')[0].click();break;case"pum-popup-title":e('a[href="#pum-theme-settings_title"]')[0].click();break;case"pum-popup-content":e('a[href="#pum-theme-settings_content"]')[0].click();break;case"pum-popup-close":e('a[href="#pum-theme-settings_close"]')[0].click()}e("html, body").animate({scrollTop:e("#pum_theme_settings").offset().top-40+"px"})}).on("change colorchange input focusout",".pum-field select, .pum-field input",function(){PUM_Admin.themeEditor.refresh_preview()}),e(function(){e(this).trigger("pum_init");var t=e("#pum-theme-settings-container"),o=pum_theme_settings_editor.form_args||{},i=pum_theme_settings_editor.current_values||{};t.length&&(t.find(".pum-no-js").hide(),PUM_Admin.forms.render(o,i,t)),PUM_Admin.themeEditor.preview_fixed_scroll(),PUM_Admin.themeEditor.refresh_preview()})})();